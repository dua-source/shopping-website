# 数据库连接问题修复方案

## 问题分析
1. 当前配置使用阿里云RDS数据库（`rm-7xvtn0z98iy86ses1.mysql.rds.aliyuncs.com`），可能存在访问权限或网络问题
2. 数据库用户名`ad`可能不正确或权限不足
3. 本地可能没有执行`shoppingdb.sql`脚本初始化数据库

## 修复步骤

### 1. 修改数据库配置
- 将`db.properties`中的数据库配置改为使用本地MySQL数据库
- 修改数据库URL、用户名和密码

### 2. 创建本地数据库
- 执行`shoppingdb.sql`脚本，创建数据库和表结构
- 插入测试数据

### 3. 确保数据库连接正常
- 检查MySQL驱动是否正确加载
- 测试数据库连接

## 具体修改

### 修改 `src/com/shopping/util/db.properties`
```properties
# 将数据库配置改为本地MySQL
# 假设本地MySQL服务已启动，用户名root，密码为空，数据库名shoppingdb
db.url=jdbc:mysql://localhost:3306/shoppingdb?useSSL=false&serverTimezone=UTC&characterEncoding=utf8
db.username=root
db.password=
db.driver=com.mysql.cj.jdbc.Driver
```

### 执行数据库脚本
```bash
# 在MySQL命令行或客户端中执行shoppingdb.sql脚本，创建数据库和表结构
mysql -u root -p < shoppingdb.sql
```

### 重新编译和打包
```bash
# 重新编译Java文件
javac -d build -cp "WebContent/WEB-INF/lib/*" src/com/shopping/**/*.java

# 复制编译结果到WEB-INF/classes
xcopy /e /i /y build WebContent/WEB-INF/classes

# 重新打包WAR文件
jar -cvf shopping.war -C WebContent .
```

### 部署到Tomcat
- 将新生成的`shopping.war`文件复制到Tomcat的`webapps`目录
- 重启Tomcat服务器
- 访问`http://localhost:8080/shopping`

## 预期效果
- 数据库连接正常
- 可以正常查询产品列表
- 可以正常注册和登录
- 购物车和订单功能正常使用